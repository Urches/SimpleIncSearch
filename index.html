<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Increment search</title>

    <style>
        #suggestion {
            display: flex;
            flex-direction: column;
        }
    </style>
    <script src="js/EventEmmiter.js"></script>
    <script src="js/Ajax.js"></script>
    <script src="js/AjaxMock.js"></script>
    <script src="js/SuggestionsStore.js"></script>
    <script>
        window.onload = function () {

            let store = new SuggestionsStore();
            let currentValue;

            document.getElementById('searchField').oninput = function (event) {
                let value = document.getElementById('searchField').value;
                if (value) {
                currentValue = value;
                    store.onPrepareSuggestion.notify(value);
                };
            };

            store.onSuggestionLoaded.subscribe((data) => {
                console.log('suggestion by: ' + data.value);
                if (currentValue == data.value) {
                    //display suggestion
                    document.getElementById('suggestion').innerHTML = '';
                    data.suggestion.forEach(str => {
                        document.getElementById('suggestion').innerHTML += '<div>' + str +
                            '</div>';
                    });
                }
            });
        }
    </script>
</head>

<body>
    <div>
        <input type="search" id='searchField'>
        <div id='suggestion'></div>
    </div>

    <button id="searchButton">search</button>
</body>

</html>